{"version":3,"sources":["../../../../src/backend/server/signaling-server/errors.js"],"names":["util","require","userModule","logger","ERR_TYPE","INVALIDMESSAGE","INVALIDUSER","SERVER_ERR","SignalingServerError","type","message","Error","call","inherits","prototype","sendErrMessage","conn","info","send","JSON","stringify","e","closeConnection","sendErrMessagewithUserID","userID","sendTo","err","module","exports","InvalidMessageError","ServerError","InvalidUserError"],"mappings":"aAAA,IAAIA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAAlB;AACA,IAAIC,UAAU,GAAGD,OAAO,CAAC,QAAD,CAAxB;AACA,IAAIE,MAAM,GAAGF,OAAO,CAAC,cAAD,CAAP,CAAwBE,MAArC;;AAEA,IAAMC,QAAQ,GAAE;AACZC,EAAAA,cAAc,EAAE,oBADJ;AAEZC,EAAAA,WAAW,EAAE,iBAFD;AAGZC,EAAAA,UAAU,EAAC,iBAHC,EAAhB;;;;AAOA,SAASC,oBAAT,CAA8BC,IAA9B,EAAmCC,OAAnC,EAA2C;;AAEvC,OAAKD,IAAL,GAAWA,IAAX;AACA,OAAKC,OAAL,GAAeA,OAAf;AACAC,EAAAA,KAAK,CAACC,IAAN,CAAW,IAAX,EAAiBF,OAAjB;;AAEH;;AAEDV,IAAI,CAACa,QAAL,CAAcL,oBAAd,EAAoCG,KAApC;;;AAGAH,oBAAoB,CAACM,SAArB,CAA+BC,cAA/B,GAAgD,UAASC,IAAT,EAAc;;AAE1D,MAAIN,OAAO,GAAG;AACVD,IAAAA,IAAI,EAAE,KAAKA,IADD;AAEVC,IAAAA,OAAO,EAAE,KAAKA,OAFJ,EAAd;;;AAKAP,EAAAA,MAAM,CAACc,IAAP,CAAY,iBAAZ,EAA8BP,OAA9B;;AAEA,MAAG;AACCM,IAAAA,IAAI,CAACE,IAAL,CAAUC,IAAI,CAACC,SAAL,CAAeV,OAAf,CAAV;AACH,GAFD,CAEC,OAAMW,CAAN,EAAQ;AACLC,IAAAA,eAAe,CAACN,IAAD,CAAf;AACH;;;AAGJ,CAhBD;;AAkBAR,oBAAoB,CAACM,SAArB,CAA+BS,wBAA/B,GAA0D,UAASC,MAAT,EAAgB;;AAEtE,MAAId,OAAO,GAAG;AACVD,IAAAA,IAAI,EAAE,KAAKA,IADD;AAEVC,IAAAA,OAAO,EAAE,KAAKA,OAFJ,EAAd;;;AAKAP,EAAAA,MAAM,CAACc,IAAP;AACI;AACC,YAFL,EAEiB,CAACO,MAAD;AACZ,aAHL,EAGkBd,OAHlB;;;;AAOAR,EAAAA,UAAU,CAACuB,MAAX,CAAkBD,MAAlB,EAAyBd,OAAzB,EAAiC,UAACgB,GAAD,EAAO;;AAEvC,GAFD;;;AAKH,CAnBD;;AAqBAC,MAAM,CAACC,OAAP,CAAepB,oBAAf,GAAqCA,oBAArC;;;AAGA,SAASqB,mBAAT,CAA6BnB,OAA7B,EAAqC;;AAEjCF,EAAAA,oBAAoB,CAACI,IAArB,CAA0B,IAA1B,EAA+BR,QAAQ,CAACC,cAAxC,EAAuDK,OAAvD;AACH;;AAEDV,IAAI,CAACa,QAAL,CAAcgB,mBAAd,EAAmCrB,oBAAnC;;AAEAmB,MAAM,CAACC,OAAP,CAAeC,mBAAf,GAAqCA,mBAArC;;;AAGA,SAASC,WAAT,CAAqBpB,OAArB,EAA6B;;AAEzBF,EAAAA,oBAAoB,CAACI,IAArB,CAA0B,IAA1B,EAA+BR,QAAQ,CAACG,UAAxC,EAAmDG,OAAnD;AACH;;AAEDV,IAAI,CAACa,QAAL,CAAciB,WAAd,EAA0BtB,oBAA1B;;AAEAmB,MAAM,CAACC,OAAP,CAAeE,WAAf,GAA6BA,WAA7B;;;AAGA,SAASC,gBAAT,CAA0BrB,OAA1B,EAAkC;;AAE9BF,EAAAA,oBAAoB,CAACI,IAArB,CAA0B,IAA1B,EAA+BR,QAAQ,CAACC,cAAxC,EAAuDK,OAAvD;AACH;;AAEDV,IAAI,CAACa,QAAL,CAAckB,gBAAd,EAA+BvB,oBAA/B;;AAEAmB,MAAM,CAACC,OAAP,CAAeG,gBAAf,GAAiCA,gBAAjC","sourcesContent":["var util = require('util')\r\nvar userModule = require('./user')\r\nvar logger = require('../../logger').logger\r\n\r\nconst ERR_TYPE ={\r\n    INVALIDMESSAGE: \"err:invalidMessage\",\r\n    INVALIDUSER: \"err:invalidUser\",\r\n    SERVER_ERR:\"err:serverError\"\r\n}\r\n\r\n\r\nfunction SignalingServerError(type,message){\r\n    \r\n    this.type =type\r\n    this.message = message\r\n    Error.call(this, message);\r\n\r\n}\r\n\r\nutil.inherits(SignalingServerError, Error);\r\n\r\n\r\nSignalingServerError.prototype.sendErrMessage = function(conn){\r\n\r\n    var message = {\r\n        type: this.type,\r\n        message: this.message\r\n    }\r\n    \r\n    logger.info(\"send errMessage\",message)\r\n\r\n    try{\r\n        conn.send(JSON.stringify(message))\r\n    }catch(e){\r\n        closeConnection(conn)\r\n    }\r\n    \r\n\r\n}\r\n\r\nSignalingServerError.prototype.sendErrMessagewithUserID = function(userID){\r\n\r\n    var message = {\r\n        type: this.type,\r\n        message: this.message\r\n    }\r\n    \r\n    logger.info(\r\n        \"send errMessage \\n\"\r\n        +\"userID: \", +userID\r\n        +\"message: \", message\r\n\r\n    )\r\n\r\n    userModule.sendTo(userID,message,(err)=>{\r\n        \r\n    })  \r\n    \r\n\r\n}\r\n\r\nmodule.exports.SignalingServerError =SignalingServerError\r\n\r\n\r\nfunction InvalidMessageError(message){\r\n\r\n    SignalingServerError.call(this,ERR_TYPE.INVALIDMESSAGE,message)\r\n}\r\n\r\nutil.inherits(InvalidMessageError, SignalingServerError);\r\n\r\nmodule.exports.InvalidMessageError = InvalidMessageError\r\n\r\n\r\nfunction ServerError(message){\r\n    \r\n    SignalingServerError.call(this,ERR_TYPE.SERVER_ERR,message)\r\n}\r\n\r\nutil.inherits(ServerError,SignalingServerError)\r\n\r\nmodule.exports.ServerError = ServerError\r\n\r\n\r\nfunction InvalidUserError(message){\r\n\r\n    SignalingServerError.call(this,ERR_TYPE.INVALIDMESSAGE,message)\r\n}\r\n\r\nutil.inherits(InvalidUserError,SignalingServerError)\r\n\r\nmodule.exports.InvalidUserError =InvalidUserError\r\n\r\n\r\n\r\n\r\n"],"file":"errors.js"}